---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kafka-producer-script
data:
  produce.py: |
    import sys
    from kafka import KafkaProducer

    producer = KafkaProducer(bootstrap_servers="kafka-test-cluster-kafka-bootstrap:9092")
    for msg in [b"hello", b"world", b"from", b"pyre"]:
        producer.send("test-topic", msg)
    producer.flush()
    print("Produced 4 messages.")
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kafka-consumer-script
data:
  consume.py: |
    import sys
    from kafka import KafkaConsumer

    consumer = KafkaConsumer(
        "test-topic",
        bootstrap_servers="kafka-test-cluster-kafka-bootstrap:9092",
        auto_offset_reset="earliest",
        consumer_timeout_ms=10000,
    )

    for msg in consumer:
        print(f"Received: {msg.value.decode()}")